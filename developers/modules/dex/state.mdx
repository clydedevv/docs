---
title: "DEX State"
description: "State management and storage in the DEX module"
---

The DEX module maintains state to track pools, reserves, limit orders, and user positions. All state objects are defined in protocol buffer files and stored in the module's key-value store.

## Core State Objects

### Pool

Represents a liquidity pool for a specific trading pair, tick, and fee combination.

```protobuf
message Pool {
  uint64 id = 1;
  PoolReserves lower_tick0 = 2;
  PoolReserves upper_tick1 = 3;
}
```

### PoolReserves

Stores the actual token reserves for a pool at a specific price point.

```protobuf
message PoolReserves {
  PoolReservesKey key = 1;
  string reserves_maker_denom = 2;
  string price_taker_to_maker = 3;
  string price_opposite_taker_to_maker = 4;
}

message PoolReservesKey {
  TradePairID trade_pair_id = 1;
  int64 tick_index_taker_to_maker = 2;
  uint64 fee = 3;
}
```

### PoolMetadata

Contains metadata information about pools.

```protobuf
message PoolMetadata {
  uint64 id = 1;
  int64 tick = 2;
  uint64 fee = 3;
  PairID pair_id = 4;
}
```

### LimitOrderTranche

Represents a group of limit orders at the same price level.

```protobuf
message LimitOrderTranche {
  LimitOrderTrancheKey key = 1;
  string reserves_maker_denom = 2;
  string reserves_taker_denom = 3;
  string total_maker_denom = 4;
  string total_taker_denom = 5;
  google.protobuf.Timestamp expiration_time = 6;
  string price_taker_to_maker = 7 [deprecated = true];
  string maker_price = 8;
}

message LimitOrderTrancheKey {
  TradePairID trade_pair_id = 1;
  int64 tick_index_taker_to_maker = 2;
  string tranche_key = 3;
}
```

### LimitOrderTrancheUser

Tracks individual user positions within limit order tranches.

```protobuf
message LimitOrderTrancheUser {
  TradePairID trade_pair_id = 1;
  int64 tick_index_taker_to_maker = 2;
  string tranche_key = 3;
  string address = 4;
  string shares_owned = 5;
  string shares_withdrawn = 6;
  string shares_cancelled = 7;
  LimitOrderType order_type = 8;
}
```

### DepositRecord

Tracks user liquidity positions in pools.

```protobuf
message DepositRecord {
  PairID pair_id = 1;
  string shares_owned = 2;
  int64 center_tick_index = 3;
  int64 lower_tick_index = 4;
  int64 upper_tick_index = 5;
  uint64 fee = 6;
  string total_shares = 7;
  Pool pool = 8;
}
```

### TickLiquidity

A union type that represents either pool reserves or limit order tranches at a tick.

```protobuf
message TickLiquidity {
  oneof liquidity {
    PoolReserves pool_reserves = 1;
    LimitOrderTranche limit_order_tranche = 2;
  }
}
```

## Identifiers

### TradePairID

Identifies the direction of a trade within a token pair.

```protobuf
message TradePairID {
  string maker_denom = 1;
  string taker_denom = 2;
}
```

### PairID

Identifies a token pair with lexicographically ordered tokens.

```protobuf
message PairID {
  string token0 = 1;
  string token1 = 2;
}
```

## Enumerations

### LimitOrderType

Defines the different types of limit orders supported.

```protobuf
enum LimitOrderType {
  GOOD_TIL_CANCELLED = 0;
  FILL_OR_KILL = 1;
  IMMEDIATE_OR_CANCEL = 2;
  JUST_IN_TIME = 3;
  GOOD_TIL_TIME = 4;
}
```

### TickLiquidityType

Distinguishes between different types of liquidity at a tick.

```protobuf
enum TickLiquidityType {
  POOL_RESERVES = 0;
  LIMIT_ORDER_TRANCHE = 1;
}
```

## State Management

The DEX module uses these state objects to:

- Track liquidity pools and their reserves
- Manage limit order tranches and user positions
- Store user deposit records and shares
- Maintain tick-based liquidity organization
- Handle order expiration and lifecycle management

State transitions occur through the various message handlers (MsgDeposit, MsgWithdrawal, MsgPlaceLimitOrder, etc.) and during automated processes like limit order expiration.

For detailed implementation specifics, refer to the Go source code in the module-reference directory.